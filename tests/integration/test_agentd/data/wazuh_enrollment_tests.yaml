-
  name: "Default Name"
  description: "No agent name in auto enrollment configuration"
  enrollment:
    response: "OSSEC K:'0 {agent_name} any TopSecret'\n"
    id: 0
  configuration:
    enabled: "yes"
-
  name: "Valid agent address"
  description: "Check a valid agent_address configurations"
  enrollment:
    response: "OSSEC K:'1 {agent_name} 192.168.0.10 TopSecret'\n"
    id: 1
  configuration:
    agent_address: "192.168.0.10"
-
  name: "Groups"
  description: "Agent groups in auto enrollment configuration"
  enrollment:
    response: "OSSEC K:'2 {agent_name} any TopSecret'\n"
    id: 2
  configuration:
    groups: "group_1"
-
  name: "Multi Groups"
  description: "Agent multi groups in auto enrollment configuration"
  enrollment:
    response: "OSSEC K:'3 {agent_name} any TopSecret'\n"
    id: 3
  configuration:
    groups: "group_1,group_2,"
-
  name: "Invalid Agent address"
  description: "Check a invalid agent_address in auto enrollment configuration"
  configuration:
    agent_address: "192.168.0.1000"
-
  name: "Invalid enabled"
  description: "Check a invalid enabled in auto enrollment configuration"
  skips:
    - agent-auth
  configuration:
    enabled: "nn"
-
  name: "Valid agent name config"
  description: "Check a valid agent_name configurations"
  enrollment:
    response: "OSSEC K:'4 test_agent any TopSecret'\n"
    id: 4
  configuration:
    agent_name: "test_agent"
-
  name: "Invalid agent name config"
  description: "Check a invalid agent_name configurations"
  configuration:
    agent_name: "test_agent/+bad" 
-
  name: "SSL - Auto Negotiation"
  description: "Try auto negotiation option"
  enrollment:
    response: "OSSEC K:'1 test_agent_1 any TopSecret'\n"
    id: 1
    protocol: "TLSv1_1"
  configuration:
    agent_name: "test_agent_1"
    auto_negotiation: "yes"
-
  name: "SSL - Auto Negotiation Negative"
  description: "Try TLSv1_1 without auto_negotiation"
  enrollment:
    protocol: "TLSv1_1"
  configuration:
    agent_name: "test_agent_1"
    auto_negotiation: "no"
-
  name: "SSL - Compatible Ciphers"
  description: "Try connecting with Compatible ciphers"
  enrollment:
    response: "OSSEC K:'2 test_agent_2 any TopSecret'\n"
    id: 2
  configuration:
    agent_name: "test_agent_2"
    ssl_cipher: "SHA256"
-
  name: "SSL - Incompatible Ciphers"
  description: "Try connecting with Incompatible ciphers"
  configuration:
    agent_name: "test_agent_3"
    ssl_cipher: "CAMELLIA"
-
  name: "Manager Verification - Valid Cert"
  description: "Try validating server with a valid certificate"
  enrollment:
    response: "OSSEC K:'3 test_agent_3 any TopSecret'\n"
    id: 3
    check_certificate: 
      valid: "yes"
  configuration:
    agent_name: "test_agent_3"
    server_ca_path: "/var/ossec/etc/manager.pem"
-
  name: "Manager Verification - Invalid Cert"
  description: "Try validating server with an invalid certificate"
  enrollment:
    check_certificate: 
      valid: "no"
  configuration:
    agent_name: "test_agent_3"
    server_ca_path: "/var/ossec/etc/manager.pem"
-
  name: "Agent Verification - Valid Cert"
  description: "Try validating agent with an invalid certificate"
  enrollment:
    response: "OSSEC K:'4 test_agent_4 any TopSecret'\n"
    id: 4
    agent_certificate: 
      valid: "yes"
  configuration:
    agent_name: "test_agent_4"
    agent_certificate_path: "/var/ossec/etc/agent.cert"
    agent_key_path: "/var/ossec/etc/agent.key"
-
  name: "Agent Verification - Invalid Cert"
  description: "Try validating agent with an invalid certificate"
  enrollment:
    agent_certificate: 
      valid: "no"
  configuration:
    agent_name: "test_agent_5"
    agent_certificate_path: "/var/ossec/etc/agent.cert"
    agent_key_path: "/var/ossec/etc/agent.key"
-
  name: "Use source IP"
  description: "Check that source IP is sent by agent"
  enrollment:
    response: "OSSEC K:'15 test_agent_5 {agent_address} TopSecret'\n"
    id: 15
  configuration:
    agent_name: "test_agent_5"
    use_source_ip: "yes"
-
  name: "Incompatible - Use source IP"
  description: "Use source IP option while trying to set an IP"
  configuration:
    agent_name: "test_agent_6"
    use_source_ip: "yes"
    agent_address: "127.0.0.1"
-
  name: "Password from string - Agent-Auth"
  description: "Check that configured password is sent on string"
  skips:
    - ossec-agentd
  enrollment:
    response: "OSSEC K:'11 test_agent_pass any TopSecret'\n"
    id: 11
  configuration:
    agent_name: "test_agent_pass"
    password:
      type: "string"
      value: "pass123"
-
  name: "Password from file - Agent-Auth"
  description: "Check that password file is open and read successfully"
  skips:
    - ossec-agentd
  enrollment:
    response: "OSSEC K:'12 test_agent_pass_file any TopSecret'\n"
    id: 12
  configuration:
    agent_name: "test_agent_pass_file"
    password:
      type: "file"
      value: "passFile"
