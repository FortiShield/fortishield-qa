---

  # REQUIRED VARIABLES
  #-------------------
  #
  # GENERIC:
  #  - (String) os: Target operating system
  #
  # LINUX
  #  - (String) target: [manager,agent]

  - name: Restart manager service on linux
    become: true
    service:
      name: wazuh-manager
      state: restarted
    when: os == 'linux' and target == 'manager'

  - name: Restart agent service on linux
    become: true
    service:
      name: "wazuh-agent"
      state: restarted
    when:  os == 'linux' and target == 'agent'

  - name: Restart wazuh on Windows
    win_shell: "Get-Service -Name WazuhSvc -ErrorAction SilentlyContinue | Restart-Service -ErrorAction SilentlyContinue"
    args:
      executable: powershell.exe
    when: os == 'windows' and target == 'agent'
