- case: Installation of a vulnerable package
  id: install_package
  description: |
    Installation of a vulnerable package
      macos: 
      Used Package: Node 17.0.1 - PKG Format
      CVES:
        amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
        arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Package: VLC 3.0.6 - Exe Format 
        CVE: ["CVE-2023-47360", "CVE-2023-47359", "CVE-2023-46814", "CVE-2022-41325", "CVE-2020-26664", "CVE-2019-19721", "CVE-2019-13962", "CVE-2019-13602", "CVE-2019-12874", "CVE-2019-5460", "CVE-2019-5459", "CVE-2019-5439"],
      ubuntu:
        Used Package Grafana 8.5.5 - .deb Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
      centos:
        Used Package Grafana - .rpm Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions: null
  body:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          ubuntu:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          windows:
            amd64: vlc-3.0.6
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
- case: Remove vulnerable package
  id: remove_package
  description: |
    Removal of a vulnerable package
      macos: 
          Used Package: Node 17.0.1 - PKG Format
          CVES Expected to mitigate:
            ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Package: VLC 3.0.6 - Exe Format 

        CVES Expected to mitigate: 
          ["CVE-2023-47360", "CVE-2023-47359", "CVE-2023-46814", "CVE-2022-41325", "CVE-2020-26664", "CVE-2019-19721", "CVE-2019-13962", "CVE-2019-13602", "CVE-2019-12874", "CVE-2019-5460", "CVE-2019-5459", "CVE-2019-5439"],
      ubuntu:
        Used Package Grafana 8.5.5 - .deb Format
        CVES Expected to mitigate:
          ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
      centos:
        Used Package Grafana - .rpm Format
        CVE Expected to mitigate:
          ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions: null
  body:
    tasks:
      - operation: remove_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          ubuntu:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          windows:
            amd64: vlc-3.0.6
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
- case: 'Upgrade: Maintain Vulnerability'
  id: upgrade_package_maintain_vulnerability
  description: |
    Upgrade of a vulnerable package which maintain vulnerability
    macos: 
        Used Package: Node 17.1.0 - PKG Format
        CVES:
          amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
          arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    windows:
      Used Package: VLC 3.0.7 - Exe Format 
      "CVE": ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    ubuntu:
      Used Package Grafana 8.5.6 - .deb Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
    centos:
      Used Package Grafana 8.5.6 - .rpm Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          ubuntu:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          windows:
            amd64: vlc-3.0.6
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-8.5.5
              arm64v8: grafana-8.5.5
            ubuntu:
              amd64: grafana-8.5.5
              arm64v8: grafana-8.5.5
            windows:
              amd64: vlc-3.0.6
            macos:
              amd64: node-v17.0.1
              arm64v8: node-v17.0.1
          to:
            centos:
              amd64: firefox-91.13.0
              arm64v8: grafana-8.5.6
            ubuntu:
              amd64: grafana-8.5.6
            windows:
              amd64: vlc-3.0.6
            macos:
              amd64: node-v17.1.0
              arm64v8: node-v17.1.0
    teardown: null
- case: 'Upgrade: New vulnerability '
  id: upgrade_package_maintain_add_vulnerability
  description: |
    Upgrade of a vulnerable package which include a new vulnerability
    macos: 
        Used Package: Node 18.11.0 - PKG Format
        CVES:  ["CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32006", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-30581", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-32222"],
    windows:
      Used Package: VLC 3.0.7.1 - Exe Format 
      "CVE": ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    ubuntu:
      Used Package Grafana 9.1.1 - .deb Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
    centos:
      Used Package Grafana 9.1.1 - .rpm Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-8.5.6
              arm64v8: grafana-8.5.6
            ubuntu:
              amd64: grafana-8.5.6
              arm64v8: grafana-8.5.6
            windows:
              amd64: vlc-3.0.7
            macos:
              amd64: node-v17.1.0
              arm64v8: node-v17.1.0
          to:
            centos:
              amd64: grafana-9.1.1
              arm64v8: grafana-9.1.1
            ubuntu:
              amd64: grafana-9.1.1
              arm64v8: grafana-9.1.1
            windows:
              amd64: vlc-3.0.7.1
            macos:
              amd64: node-v18.11.0
              arm64v8: node-v18.11.0
    teardown: null
- case: 'Upgrade: Maintain and new vulnerability '
  id: upgrade_package_maintain_add_vulnerability
  description: >
    Upgrade of a vulnerable package which maintain vulnerabilities and include
    new ones

    macos: 
        Used Package: Node 18.12.0 - PKG Format
        "CVE": ["CVE-2023-44487", "CVE-2023-38552", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-23936", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-43548", "CVE-2022-3786", "CVE-2022-3602"],
    windows:
      Used Package: VLC 3.0.11 - Exe Format 
      "CVE": ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    ubuntu:
      Used Package Grafana 9.2.0 - .deb Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
    centos:
      Used Package Grafana 9.2.0 - .rpm Format
      CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-9.1.1
              arm64v8: grafana-9.1.1
            ubuntu:
              amd64: grafana-9.1.1
              arm64v8: grafana-9.1.1
            windows:
              amd64: vlc-3.0.7.1
            macos:
              amd64: node-v18.11.0
              arm64v8: node-v18.11.0
          to:
            centos:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            ubuntu:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            windows:
              amd64: vlc-3.0.11
            macos:
              amd64: node-v18.12.0
              arm64v8: node-v18.12.0
    teardown: null
- case: 'Upgrade: Cease vulnerability'
  id: upgrade_package_remove_vulnerability
  description: |
    Upgrade of a vulnerable which cease to be vulnerable
    macos: 
        Used Package: Node 19.5.0 - PKG Format
        "CVE": [],
    windows:
      Used Package: VLC 3.0.11 - Exe Format 
      "CVE": [],
    ubuntu:
      Used Package Grafana 9.4.17 - .deb Format
      CVE: []
    centos:
      Used Package Grafana 9.4.17 - .rpm Format
      CVE: []
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            ubuntu:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            windows:
              amd64: vlc-3.0.11
            macos:
              amd64: node-v18.12.0
              arm64v8: node-v18.12.0
          to:
            centos:
              amd64: grafana-9.4.17
              arm64v8: grafana-9.4.17
            ubuntu:
              arm64v8: grafana-9.4.17
              amd64: grafana-9.4.17
            windows:
              amd64: vlc-3.0.20
            macos:
              amd64: node-v19.5.0
              arm64v8: node-v19.5.0
    teardown: null
- case: 'Upgrade: Non vulnerable to non vulnerable'
  id: upgrade_package_nonvulnerable_to_nonvulnerable
  description: |
    Upgrade of a non vulnerable package to non vulnerable
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  preconditions:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          windows:
            amd64: node-v19.5.0
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-9.4.17
              arm64v8: grafana-9.4.17
            ubuntu:
              arm64v8: grafana-9.4.17
              amd64: grafana-9.4.17
            windows:
              amd64: vlc-3.0.20
            macos:
              amd64: node-v19.5.0
              arm64v8: node-v19.5.0
          to:
            centos:
              amd64: grafana-9.5.13
              arm64v8: grafana-9.5.13
            ubuntu:
              amd64: grafana-9.5.13
              arm64v8: grafana-9.5.13
            windows:
              amd64: node-v19.6.0
            macos:
              amd64: node-v19.6.0
              arm64v8: node-v19.6.0
    teardown: null
- case: 'Upgrade: Non vulnerable to vulnerable package'
  id: upgrade_package_nonvulnerable_to_vulnerable
  description: |
    Upgrade to non vulnerable package to vulnerable
      macos: 
          Used Package: Node 20.0.0 - PKG Format
          "CVE": ["CVE-2023-44487", "CVE-2023-39332", "CVE-2023-39331", "CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32558", "CVE-2023-32006", "CVE-2023-32005", "CVE-2023-32004", "CVE-2023-32003", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30586", "CVE-2023-30585", "CVE-2023-30581"],
      windows:
        Used Package: Node 20.0.0 - Exe Format 
        "CVE": ["CVE-2023-44487", "CVE-2023-39332", "CVE-2023-39331", "CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32558", "CVE-2023-32006", "CVE-2023-32005", "CVE-2023-32004", "CVE-2023-32003", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30586", "CVE-2023-30585", "CVE-2023-30581"],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: ["CVE-2023-4822", "CVE-2023-4399"],
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: ["CVE-2023-4822", "CVE-2023-4399"],
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: firefox-91.13.0
              arm64v8: grafana-8.5.5
            ubuntu:
              amd64: grafana-8.5.5
            windows:
              amd64: vlc-3.0.6
            macos:
              amd64: node-v19.6.0
              arm64v8: node-v19.6.0
          to:
            centos:
              amd64: firefox-91.13.0
              arm64v8: grafana-8.5.5
            ubuntu:
              amd64: grafana-8.5.5
            windows:
              amd64: vlc-3.0.6
            macos:
              amd64: node-v20.0.0
              arm64v8: node-v20.0.0
    teardown: null
- case: Installation of a non vulnerable package
  id: install_package_non_vulnerable
  description: |
    Installation of a non vulnerable package
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  preconditions: null
  body:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          ubuntu:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          windows:
            amd64: node-v19.6.0
          macos:
            amd64: node-v19.6.0
            arm64v8: node-v19.6.0
- case: 'Remove: Non vulnerable package'
  id: remove_non_vulnerable_packge
  description: |
    Removal of a non vulnerable package
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  body:
    tasks:
      - operation: remove_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          ubuntu:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          windows:
            amd64: node-v19.6.0
          macos:
            amd64: node-v19.6.0
            arm64v8: node-v19.6.0
    teardown: null

