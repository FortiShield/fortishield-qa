- case: "Installation of a vulnerable package"
  id: "install_package"
  description: "Installation of a vulnerable package"
  preconditions: null
  body:
    tasks:
      - install_package:
          package:
            centos: https://downloads.rclone.org/v1.49.5/rclone-v1.49.5-linux-amd64.rpm
            ubuntu: https://downloads.rclone.org/v1.49.5/rclone-v1.49.5-linux-amd64.deb
    check_alerts:
        centos:
          - event: install_package
            name: "rclone"
            version: "1.49.5"
        ubuntu:
          - event: install_package
            name: "rclone"
            version: "1.49.5"
  teardown:
    - remove_package:
        package:
          centos: rclone
          ubuntu: rclone

- case: "Updating a vulnerable package that remains vulnerable to the same CVE"
  id: "update_vuln_package_remain_vulnerable"
  description: "Updating a vulnerable package that remains vulnerable to the same CVE"
  preconditions:
      tasks:
        - install_package:
            package:
              centos: https://downloads.rclone.org/v1.49.5/rclone-v1.49.5-linux-amd64.rpm
              ubuntu: https://downloads.rclone.org/v1.49.5/rclone-v1.49.5-linux-amd64.deb
      check_alerts:
          centos:
            - event: install_package
              name: "rclone"
              version: "1.49.5"
          ubuntu:
              - event: install_package
                name: "rclone"
                version: "1.49.5"
  body:
    tasks:
      - install_package:
          package:
            centos: https://downloads.rclone.org/v1.50.0/rclone-v1.50.0-linux-amd64.rpm
            ubuntu: https://downloads.rclone.org/v1.50.0/rclone-v1.50.0-linux-amd64.deb
    check_alerts:
        centos:
          - event: upgrade_package
            name: "rclone"
            version: "1.50.0"
        ubuntu:
            - event: upgrade_package
              name: "rclone"
              version: "1.50.0"
  teardown:
    - remove_package:
        package:
          centos: rclone
          ubuntu: rclone

#  ----

# - case: "Updating a vulnerable package that becomes vulnerable to another CVE"
#   id: "update_vuln_package_additional_vulnerablility"
#   description: "Updating a vulnerable package that becomes vulnerable to another CVE"
#   preconditions:
#       tasks:
#         - install_package:
#             package:
#               centos: https://nmap.org/dist/nmap-6.47-1.x86_64.rpm
#               ubuntu: https://sourceforge.net/projects/webadmin/files/webmin/1.999/webmin_1.999_all.deb/download
#       check_alerts:
#           centos:
#             - event: install_package
#               name: "nmap"
#               version: "6.47"
#           ubuntu:
#               - event: install_package
#                 name: "webmin"
#                 version: "1.999"
#   body:
#     tasks:
#       - install_package:
#           package:
#             centos: https://nmap.org/dist/nmap-7.00-1.x86_64.rpm
#             ubuntu: https://sourceforge.net/projects/webadmin/files/webmin/1.999/webmin_2.000_all.deb/download
#     check_alerts:
#         centos:
#           - event: upgrade_package
#             name: "nmap"
#             version: "7.00"
#         ubuntu:
#             - event: upgrade_package
#               name: "webmin"
#               version: "2.000"
#   teardown:
#     - remove_package:
#         package:
#           centos: nmap
#           ubuntu: webmin


# ------------------------

- case: "Vulnerable package that update is also vulnerable to another CVE"
  id: "update_vuln_package_additional_vulnerablility"
  description: "Vulnerable package that update is also vulnerable to another CVE"
  preconditions:
      tasks:
        - install_package:
            package:
              centos: https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.2/x86_64/RPMS/mongodb-org-server-4.2.11-1.el7.x86_64.rpm
              ubuntu: https://repo.mongodb.org/apt/ubuntu/dists/bionic/mongodb-org/4.2/multiverse/binary-amd64/mongodb-org-server_4.2.11_amd64.deb
      check_alerts:
          centos:
            - event: install_package
              name: "mongodb"
              version: "4.2.11"
          ubuntu:
            - event: install_package
              name: "mongodb"
              version: "4.2.11"
  body:
    tasks:
      - install_package:
          package:
            centos: https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.4/x86_64/RPMS/mongodb-org-server-4.4.10-1.el7.x86_64.rpm
            ubuntu: https://repo.mongodb.org/apt/ubuntu/dists/focal/mongodb-org/4.4/multiverse/binary-amd64/mongodb-org-server_4.4.10_amd64.deb
    check_alerts:
        centos:
          - event: upgrade_package
            name: "mongodb"
            version: "4.4.10"
        ubuntu:
          - event: upgrade_package
            name: "mongodb"
            version: "4.4.10"
  teardown:
    - remove_package:
        package:
          centos: mongodb
          ubuntu: mongodb


- case: "Vulnerable package that update cease to be vulnerable"
  id: "update_vuln_package_cease_vuln"
  description: "Vulnerable package that update cease to be vulnerable"
  preconditions:
      tasks:
        - install_package:
            package:
              centos: https://master.dl.sourceforge.net/project/webadmin/webmin/2.003/webmin-2.003-1.noarch.rpm
              ubuntu: https://master.dl.sourceforge.net/project/webadmin/webmin/2.003/webmin_2.003_all.deb
      check_alerts:
          centos:
            - event: install_package
              name: "webmin"
              version: "2.003"
          ubuntu:
            - event: install_package
              name: "webmin"
              version: "2.003"
  body:
    tasks:
      - install_package:
          package:
            centos: https://kumisystems.dl.sourceforge.net/project/webadmin/webmin/2.000/webmin-2.000-1.noarch.rpm
            ubuntu: https://altushost-swe.dl.sourceforge.net/project/webadmin/webmin/2.000/webmin_2.000_all.deb
    check_alerts:
        centos:
          - event: upgrade_package
            name: "webmin"
            version: "2.000"
        ubuntu:
          - event: upgrade_package
            name: "webmin"
            version: "2.000"
  teardown:
    - remove_package:
        package:
          centos: webmin
          ubuntu: webmin




#  "Deleting a vulnerable package"



# - case: "Installation of a non-vulnerable package"



# - case: "Updating a non-vulnerable package that becomes vulnerable"



# Updating of a non-vulnerable package that remains non-vulnerable



# Deletion of a non-vulnerable package
