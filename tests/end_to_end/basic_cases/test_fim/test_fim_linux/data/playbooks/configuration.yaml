- name: Test case configuration
  hosts: wazuh-agent
  tasks:

    - name: Create directory to monitor (Linux)
      become: true
      file:
        path: /tmp/test_demo_fim
        state: directory

    - name: Add directory to syscheck configuration (Linux)
      include_role:
        name: manage_wazuh_configurations
        tasks_from: write_wazuh_config.yaml
      vars:
        config_block: |
          <syscheck>
          <directories check_all="yes" whodata="yes">/tmp/test_demo_fim</directories>
          </syscheck>
        os: linux

    - name: Restart wazuh-agent
      include_role:
        name: manage_wazuh
        tasks_from: restart_wazuh.yaml
      vars:
        os: linux
