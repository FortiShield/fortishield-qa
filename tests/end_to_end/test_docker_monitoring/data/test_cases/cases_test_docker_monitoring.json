[
    {
        "name": "docker_pull",
        "description": "Test if an alert is generated when using the `pull` command.",
        "configuration_parameters": {},
        "metadata": {
            "opensearch_query": {
                "query": {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "rule.id": "87932"
                                }
                            },
                            {
                                "term": {
                                    "rule.description": "Docker: Image or repository nginx pulled"
                                }
                            },
                            {
                                "term": {
                                    "data.docker.Action": "pull"
                                }
                            }
                        ]
                    }
                }
            },
            "regex": ".+\"docker\":.+\"Action\": \"(pull)\".+\"Attributes\":.+\"(nginx)\".+\"description\": \"(Docker: Image or repository nginx pulled)\".+"
        }
    },
    {
        "name": "docker_run",
        "description": "Test if an alert is generated when using the `pull` command.",
        "configuration_parameters": {},
        "metadata": {
            "opensearch_query": {
                "query": {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "rule.id": "87903"
                                }
                            },
                            {
                                "term": {
                                    "rule.description": "Docker: Container nginx_container started"
                                }
                            },
                            {
                                "term": {
                                    "data.docker.Action": "start"
                                }
                            }
                        ]
                    }
                }
            },
            "regex": ".+\"docker\":.+\"Action\": \"(start)\".+\"image\": \"(nginx)\".+\"description\": \"(Docker: Container nginx_container started)\".+"
        }
    },
    {
        "name": "docker_exec",
        "description": "Test if an alert is generated when using the `exec` command.",
        "configuration_parameters": {},
        "metadata": {
            "opensearch_query": {
                "query": {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "rule.id": "87908"
                                }
                            },
                            {
                                "term": {
                                    "rule.description": "Docker: Started shell session in container nginx_container"
                                }
                            },
                            {
                                "term": {
                                    "data.docker.Action": "exec_start: /bin/bash "
                                }
                            }
                        ]
                    }
                }
            },
            "regex": ".+\"docker\":.+\"Action\": \"(exec_start: /bin/bash )\".+\"image\": \"(nginx)\".+\"description\": \"(Docker: Started shell session in container nginx_container)\".+"
        }
    },
    {
        "name": "docker_stop_rm",
        "description": "Test if an alert is generated when using the `exec` command.",
        "configuration_parameters": {},
        "metadata": {
            "opensearch_query": {
                "query": {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "rule.id": "87902"
                                }
                            },
                            {
                                "term": {
                                    "rule.description": "Docker: Container nginx_container destroyed"
                                }
                            },
                            {
                                "term": {
                                    "data.docker.Action": "destroy"
                                }
                            }
                        ]
                    }
                }
            },
            "regex": ".+\"docker\":.+\"Action\": \"(destroy)\".+\"image\": \"(nginx)\".+\"description\": \"(Docker: Container nginx_container destroyed)\".+"
        }
    }
]