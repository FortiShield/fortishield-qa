---
- name: docker_pull
  description: Test if an alert is generated when using the `pull` command.
  configuration_parameters: null
  metadata:
    rule.id: '87932'
    rule.description: 'Docker: Image or repository nginx pulled'
    extra:
      data.docker.Action: pull
    extra_vars:
      event_description: Run 'docker pull nginx'
      command: docker pull nginx

- name: docker_run
  description: Test if an alert is generated when using the `run` command.
  configuration_parameters: null
  metadata:
    rule.id: '87903'
    rule.description: 'Docker: Container nginx_container started'
    extra:
      data.docker.Action: start
    extra_vars:
      event_description: Run 'docker run -d -P --name nginx_container nginx'
      command: docker run -d -P --name nginx_container nginx

- name: docker_exec
  description: Test if an alert is generated when using the `exec` command.
  configuration_parameters: null
  metadata:
    rule.id: '87908'
    rule.description: 'Docker: Started shell session in container nginx_container'
    extra:
      data.docker.Action: 'exec_start: /bin/bash '
    extra_vars:
      event_description: Run 'docker exec -d nginx_container /bin/bash'
      command: docker exec -d nginx_container /bin/bash

- name: docker_stop_rm
  description: Test if an alert is generated when using the `stop` and `rm` commands.
  configuration_parameters: null
  metadata:
    rule.id: '87902'
    rule.description: 'Docker: Container nginx_container destroyed'
    extra:
      data.docker.Action: destroy
    extra_vars:
      event_description: Run 'docker stop `docker ps -a -q` && docker rm `docker ps -a -q`'
      command: docker stop `docker ps -a -q` && docker rm `docker ps -a -q`
