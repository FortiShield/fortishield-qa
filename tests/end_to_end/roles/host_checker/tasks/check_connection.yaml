# REQUIRED VARIABLES
# -------------------
# (String) os: Target operating system

- name: Try connection (Linux)
  ping:
  when: os == 'Linux'
  ignore_errors: true
  register: result

- name: Check if host is reachable (Linux)
  set_fact:
    failed: true
    errors: "{{ inventory_hostname }} is unreachable."
  when: '"ping" not in result.keys() and os == "Linux"'

- name: Try connection (Windows)
  win_ping:
  when: os == 'Windows'
  ignore_errors: true
  register: result

- name: Check if host is reachable (Windows)
  set_fact:
    failed: true
    errors: "{{ inventory_hostname }} is unreachable."
  when: '"ping" not in result.keys() and os == "Windows"'
